!function(e,t){"function"==typeof define&&define.amd?define("priorityNav",t(e)):"object"==typeof exports?module.exports=t(e):e.priorityNav=t(e)}(window||this,function(e){"use strict";function t(e,t,n){var o;return function(){var r=this,i=arguments,a=function(){o=null,n||e.apply(r,i)},s=n&&!o;clearTimeout(o),o=setTimeout(a,t),s&&e.apply(r,i)}}var n,o,r,i,a,s,l,d,c={},u=[],p=!!document.querySelector&&!!e.addEventListener,v={},f=0,h=0,m=0,y={initClass:"js-priorityNav",mainNavWrapper:"nav",mainNav:"ul",navDropdownClassName:"nav__dropdown",navDropdownToggleClassName:"nav__dropdown-toggle",navDropdownLabel:"more",navDropdownBreakpointLabel:"menu",breakPoint:500,throttleDelay:50,offsetPixels:0,count:!0,moved:function(){},movedBack:function(){}},w=function(e,t,n){if("[object Object]"===Object.prototype.toString.call(e))for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(n,e[o],o,e);else for(var r=0,i=e.length;i>r;r++)t.call(n,e[r],r,e)},S=function(e,t){for(var n=t.charAt(0);e&&e!==document;e=e.parentNode)if("."===n){if(e.classList.contains(t.substr(1)))return e}else if("#"===n){if(e.id===t.substr(1))return e}else if("["===n&&e.hasAttribute(t.substr(1,t.length-2)))return e;return!1},g=function(e,t){var n={};return w(e,function(t,o){n[o]=e[o]}),w(t,function(e,o){n[o]=t[o]}),n},q=function(e,t){if(e.classList)e.classList.toggle(t);else{var n=e.className.split(" "),o=n.indexOf(t);o>=0?n.splice(o,1):n.push(t),e.className=n.join(" ")}},L=function(e,t){return d=document.createElement("span"),a=document.createElement("ul"),s=document.createElement("button"),s.innerHTML=t.navDropdownLabel,s.setAttribute("aria-controls","menu"),s.setAttribute("type","button"),a.setAttribute("aria-hidden","true"),e.querySelector(i).parentNode!==e?void console.warn("mainNav is not a direct child of mainNavWrapper, double check please"):(e.insertAfter(d,e.querySelector(i)),d.appendChild(s),d.appendChild(a),a.classList.add(t.navDropdownClassName),a.classList.add("priority-nav__dropdown"),s.classList.add(t.navDropdownToggleClassName),s.classList.add("priority-nav__dropdown-toggle"),d.classList.add(t.navDropdownClassName+"-wrapper"),d.classList.add("priority-nav__wrapper"),void e.classList.add("priority-nav"))},b=function(e){var t=window.getComputedStyle(e),n=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.clientWidth-n},N=function(){var e=document,t=window,n=e.compatMode&&"CSS1Compat"===e.compatMode?e.documentElement:e.body,o=n.clientWidth,r=n.clientHeight;return t.innerWidth&&o>t.innerWidth&&(o=t.innerWidth,r=t.innerHeight),{width:o,height:r}},C=function(e){o=b(e),l=e.querySelector(a).parentNode===e?e.querySelector(a).offsetWidth:0,r=k(e)+v.offsetPixels,m=N().width};c.doesItFit=function(e){var n=0===e.getAttribute("instance")?n:v.throttleDelay;f++,t(function(){var t=e.getAttribute("instance");for(C(e);r>=o&&e.querySelector(i).children.length>0||m<v.breakPoint&&e.querySelector(i).children.length>0;)c.toDropdown(e,t),C(e),m<v.breakPoint&&A(e,t,v.navDropdownBreakpointLabel);for(;o>=u[t][u[t].length-1]&&m>v.breakPoint;)c.toMenu(e,t),m>v.breakPoint&&A(e,t,v.navDropdownLabel);u[t].length<1&&(e.querySelector(a).classList.remove("show"),A(e,t,v.navDropdownLabel)),e.querySelector(i).children.length<1?(e.classList.add("is-empty"),A(e,t,v.navDropdownBreakpointLabel)):e.classList.remove("is-empty"),D(e,t)},n)()};var D=function(e,t){u[t].length<1?(e.querySelector(s).classList.add("priority-nav-is-hidden"),e.querySelector(s).classList.remove("priority-nav-is-visible"),e.classList.remove("priority-nav-has-dropdown"),e.querySelector(".priority-nav__wrapper").setAttribute("aria-haspopup","false")):(e.querySelector(s).classList.add("priority-nav-is-visible"),e.querySelector(s).classList.remove("priority-nav-is-hidden"),e.classList.add("priority-nav-has-dropdown"),e.querySelector(".priority-nav__wrapper").setAttribute("aria-haspopup","true"))},E=function(e,t){e.querySelector(s).setAttribute("priorityNav-count",u[t].length)},A=function(e,t,n){e.querySelector(s).innerHTML=n};c.toDropdown=function(e,t){e.querySelector(a).firstChild&&e.querySelector(i).children.length>0?e.querySelector(a).insertBefore(e.querySelector(i).lastElementChild,e.querySelector(a).firstChild):e.querySelector(i).children.length>0&&e.querySelector(a).appendChild(e.querySelector(i).lastElementChild),u[t].push(r),D(e,t),e.querySelector(i).children.length>0&&v.count&&E(e,t),v.moved()},c.toMenu=function(e,t){e.querySelector(a).children.length>0&&e.querySelector(i).appendChild(e.querySelector(a).firstElementChild),u[t].pop(),D(e,t),e.querySelector(i).children.length>0&&v.count&&E(e,t),v.movedBack()};var k=function(e){for(var t=e.childNodes,n=0,o=0;o<t.length;o++)3!==t[o].nodeType&&(isNaN(t[o].offsetWidth)||(n+=t[o].offsetWidth));return n},T=function(e,t){window.attachEvent?window.attachEvent("onresize",function(){c.doesItFit&&c.doesItFit(e)}):window.addEventListener&&window.addEventListener("resize",function(){c.doesItFit&&c.doesItFit(e)},!0),e.querySelector(s).addEventListener("click",function(){q(e.querySelector(a),"show"),q(this,"is-open"),q(e,"is-open"),-1!==e.className.indexOf("is-open")?e.querySelector(a).setAttribute("aria-hidden","false"):(e.querySelector(a).setAttribute("aria-hidden","true"),e.querySelector(a).blur())}),document.addEventListener("click",function(n){S(n.target,"."+t.navDropdownClassName)||n.target===e.querySelector(s)||(e.querySelector(a).classList.remove("show"),e.querySelector(s).classList.remove("is-open"),e.classList.remove("is-open"))}),document.onkeydown=function(e){e=e||window.event,27===e.keyCode&&(document.querySelector(a).classList.remove("show"),document.querySelector(s).classList.remove("is-open"),n.classList.remove("is-open"))}};Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=0,t=this.length;t>e;e++)this[e]&&this[e].parentElement&&this[e].parentElement.removeChild(this[e])},c.destroy=function(){v&&(document.documentElement.classList.remove(v.initClass),d.remove(),v=null,delete c.init,delete c.doesItFit)},p&&"undefined"!=typeof Node&&(Node.prototype.insertAfter=function(e,t){this.insertBefore(e,t.nextSibling)});var _=function(e){var t=e.charAt(0);return"."!==t&&"#"!==t};return c.init=function(e){if(v=g(y,e||{}),!p&&"undefined"==typeof Node)return void console.warn("This browser doesn't support priorityNav");if(!_(v.navDropdownClassName)||!_(v.navDropdownToggleClassName))return void console.warn("No symbols allowed in navDropdownClassName & navDropdownToggleClassName. These are not selectors.");var t=document.querySelectorAll(v.mainNavWrapper);w(t,function(e){return u[h]=[],e.setAttribute("instance",h++),(n=e)?(i=v.mainNav,e.querySelector(i)?(L(e,v),a="."+v.navDropdownClassName,e.querySelector(a)?(s="."+v.navDropdownToggleClassName,e.querySelector(s)?(T(e,v),void c.doesItFit(e)):void console.warn("couldn't find the specified navDropdownToggle element")):void console.warn("couldn't find the specified navDropdown element")):void console.warn("couldn't find the specified mainNav element")):void console.warn("couldn't find the specified mainNavWrapper element")}),f++,document.documentElement.classList.add(v.initClass)},c});